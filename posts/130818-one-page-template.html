<title>130818-one-page-template.md</title><meta charset='utf-8'><link rel='stylesheet' href='../src/page.css' /><link rel='stylesheet'  href='http://softwaremaniacs.org/media/soft/highlight/styles/github.css'><div class='home'><a href='../index.html '>Home</a></div><div class='article'><h2>One Page 模版</h2>
<p>Grunt 和 Bower 在寒假时候我看过, 那些天晚上村里还舞龙灯<br>Bower 因为我倾向 Browserify 阵营, 心理上有点排斥, 毕竟麻烦很多<br>我的立场是代码应该方便抽象, 第 N 次面对同一个问题时应该直接用现成方案<br>只是 CSS 和 HTML 缺乏抽象, JS 能做了, 页面未必能做<br>还有我个人因为是用代码来展示想法, 避免重复就很必要, 公司代码大概不一样<br>不过由于公司用到 Grunt, 我拖时间再学习了下 Grunt 的细节</p>
<p>前端代码现在的状态, 就是一种不方便抽像的代码, 有点像汇编<br>调试的时候要每个元素看, CSS 调试要每个节点手动对付选择器和颜色<br>JS 编码过程手动绑定事件, 进行原生的 DOM 操作等等琐碎的内容<br>但编程最想要的是问题只被解决一次, 或者是第 N 次能用前面解决的方案<br>Shadow DOM 和 Web Components 的规划是必需的, 否则就是底层<br>像 Angular 就通过代码来生成 DOM, 精彩地实现了抽象的功能</p>
<p>前些天看到 <a href="https://github.com/components">Components</a> 这个 Github 主页, 看了半天才看懂<br>这个 Organization 的维护者有 Google 和 Twitter 的 JS 大神<br>而且和 Bower 关系密切, 急的 Paul Irish 有个演讲说..<br>Yeoman 封装了各种 Google 认为的 Best practives, 其中包括 Bower<br>可我觉得 Bower 还是没解决多大问题嘛, 只是解决了第一步..</p>
<h3>One Page</h3>
<p><a href="https://github.com/jiyinyiyong/one-page">one-page</a> 的仓库在 Github 上, 可以直接 <code>git clone</code> 套用<br>具体在 README 里我写了, 比较初级的英文, 熟悉 Git 和 NPM 就不难<br>我个人的习惯吧, 使用 CoffeeScript, Stylus, Jade 来写代码:</p>
<pre><code>➤➤ tree -I node_modules
.
├── Gruntfile<span class="preprocessor">.coffee</span>
├── README<span class="preprocessor">.md</span>
├── build
│   ├── bundle<span class="preprocessor">.js</span>
│   ├── index<span class="preprocessor">.html</span>
│   └── layout<span class="preprocessor">.css</span>
├── coffee
│   ├── main<span class="preprocessor">.coffee</span>
│   └── utils<span class="preprocessor">.coffee</span>
├── jade
│   ├── head<span class="preprocessor">.jade</span>
│   └── index<span class="preprocessor">.jade</span>
├── package<span class="preprocessor">.json</span>
└── stylus
    ├── layout<span class="preprocessor">.styl</span>
    └── <span class="keyword">set</span>-body<span class="preprocessor">.styl</span></code></pre>
<p>主要从下面几个方面进行了考虑:</p>
<ul>
<li>用 <code>grunt-contrib-watch</code> 和 LiveReload 插件完成了自动刷新的步骤</li>
<li>用 Browserify 进行 CoffeeScript 代码的模块化和 SourceMaps 编译</li>
<li>用 Jade 的 <code>include</code> 来加载模块的局部代码, 进行抽象</li>
<li>用 Stylus <code>@import</code> 来完成 CSS 的文件拆分, 虽然漏洞颇多</li>
<li>Grunt 管理 Watch 和 Compile 等等流程, 方便上手</li>
</ul>
<h3>Watch 问题</h3>
<p>以前的命令行都是自身实现的 Watch 极致的, 比如 Browserify 也有<br>另外对 Jade 也有, 但如果是多个文件, Grunt Task 写法就导致多余的重新编译<br>现在我强制 Stylus Jade 编译到单一的结果, 刷新次数就对了</p>
<p>现在开发前端不用频繁刷新怎么写啊.. 编辑器功能这么贫乏的年代</p>
<h3>类库</h3>
<p>类库我没具体考虑过, JS 用 Browserify 自己改一下问题不大<br>如果引入第三方的模块, 现在只能接受手动逐个引入资源文件了<br>就搞不明白<a href="http://ruby-china.org/topics/13364">浏览器为什么不提供基于模块的缓存, 其他语言很多呀</a><br>以后学 Angular 也许有好一些的方案, 希望真的有...</p>
<h3>模版引擎</h3>
<p>发现 Jade 可以用来做 pre-compile 的模版引擎, 觉得坑少多了<br>不过 Jade 还是有些问题, pre-compile 不是现成的, Grunt 插件倒是可以<br>pre-compile 以后速度块很多, <a href="http://cnodejs.org/topic/5208e90944e76d216aef3050">具体我写的测试不够详细不确定</a><br>另外 Jade 的文档最近有翻修过, 过段时间可能又要人翻译中文.. 忙呃逃了</p>
<h3>Grunt 自动化</h3>
<p>之前我写过两个模块用来给自己的项目做自动编译之类事情的<br>一个是 <a href="https://github.com/jiyinyiyong/calabash/">calabash</a>, 用 CoffeeScript 语法写 Bash 命令后台跑的<br>一个是 <a href="https://github.com/jiyinyiyong/doodle">doodle</a> 做监视文件自动刷新页面的事情<br>昨天一试发现 Grunt 上直接来也不是很难用, 谁让用 Grunt 的人多呢</p>
<p>Grunt 主要写法和 Node 风格有差异让我不爽, 但用起来其实也问题不大<br>晚上微博上看还有中文 Grunt 文档, 佩服了: <a href="http://www.gruntjs.org/">http://www.gruntjs.org/</a><br>Grunt 提供的路径展开功能非常实用, 也符合我对这样一个工具的期望<br>只是, Node 模块使用, <code>exports</code> 书写, 子进程等一定程度被弄乱了不好</p>
<h3>相关链接</h3>
<p>我用到的几个链接贴在这里吧, 也许有用:</p>
<p><a href="http://gruntjs.com/getting-started">http://gruntjs.com/getting-started</a><br><a href="https://github.com/gruntjs/grunt/wiki/Sample-Gruntfile">https://github.com/gruntjs/grunt/wiki/Sample-Gruntfile</a><br><a href="https://github.com/gruntjs/grunt-contrib-jade">https://github.com/gruntjs/grunt-contrib-jade</a><br><a href="https://github.com/gruntjs/grunt-contrib-watch">https://github.com/gruntjs/grunt-contrib-watch</a><br><a href="https://github.com/gruntjs/grunt-contrib-stylus">https://github.com/gruntjs/grunt-contrib-stylus</a><br><a href="https://github.com/jmreidy/grunt-browserify">https://github.com/jmreidy/grunt-browserify</a><br><a href="https://github.com/visionmedia/jade/blob/master/jade-language.md">https://github.com/visionmedia/jade/blob/master/jade-language.md</a></p>
</div><div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'jiyinyiyong';
      // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script');
          dsq.type = 'text/javascript';
          dsq.async = true;
          dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
          if (document.getElementsByTagName('head')[0]) {
            document.getElementsByTagName('body')[0].appendChild(dsq);
          }
      })();
  </script>
  <noscript>
    Please enable JavaScript to view the
    <a href="http://disqus.com/?ref_noscript">
      comments powered by Disqus.
    </a>
  </noscript>
  <a href="http://disqus.com" class="dsq-brlink">
    comments powered by
    <span class="logo-disqus">
      Disqus
    </span>
  </a>
</div><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-41753901-1', 'jiyinyiyong.github.io');
  ga('send', 'pageview');
</script>