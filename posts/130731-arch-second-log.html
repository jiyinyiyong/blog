<title>130731-arch-second-log.md</title><meta charset='utf-8'><link rel='stylesheet' href='../src/page.css' /><link rel='stylesheet'  href='http://softwaremaniacs.org/media/soft/highlight/styles/github.css'><div class='home'><a href='../index.html '>Home</a></div><div class='article'><h1>第二轮装 Arch... 把用到的几个链接放在这里</h1>
<p>原文在 Issues: <a href="https://github.com/jiyinyiyong/blog2/issues/1">https://github.com/jiyinyiyong/blog2/issues/1</a></p>
<p>前面由于 <a href="http://weibo.com/1574434782/z39tLfyRs">Arch 升级到 systemd 导致 grub 和 GNOME3 不兼容的问题</a> 不能正常进入系统<br>昨天下午努力在虚拟机尝试了一遍, 昨晚安装完成, 早上继续收尾, 还是比较流畅的<br>总体感觉 Arch 安装非常方便, 只是学习曲线较陡, 并且可能遇到一些难缠的 bug<br>对于前者, 建议多看<a href="http://www.archlinuxcn.org/">Arch 中文官方站点</a>, 多上<a href="https://bbs.archlinuxcn.org/">论坛</a>和<a href="https://groups.google.com/forum/?fromgroups#!forum/archlinux-cn">邮件列表</a>, 保持信息的畅通和活跃<br>对于后者, Google 和论坛发帖大概是手头仅有的方案, Wiki 和英文社区的方案比较靠谱</p>
<p>我下载的是 <a href="http://mirrors.163.com/archlinux/iso/">2012.11.01</a> 放出的镜像, 已经<a href="https://www.archlinuxcn.org/systemd-is-now-the-default-on-new-installations/">切换到了 <code>systemd</code> 作为默认</a><br>安装的主体部分参考上次安装参考的<a href="http://blog.rebill.info/archives/arch-linux-2012-07-15-install-guide.html">ArchLinux 2012.07.15 安装教程</a>进行,<br>关于时间更新的版本参考了<a href="http://sandy.is-programmer.com/posts/36189.html">Archlinux 2012.10 u盘启动安装到硬盘配置记录</a>来安装<br>流程大概是先从 LiveUSB 进入系统, 用 <code>fdisk /dev/sda</code> 在安装的硬盘上分区<br>然后用 <code>mkfs.ext3 mkswap mkfs.ext4</code> 格式化分区, 注意 <code>/boot</code> 我用了 <code>ext3</code><br>这里还是要用 <code>dhcpcd</code> 联网, 我在局域网里所以比较方便, 建议用网线<br>然后挂载 <code>/dev/sda</code> 3 个分区到 <code>/mnt</code> 相应目录, 并用 <code>pacstrap</code> 往其中安装基础的软件<br>按提示除了 <code>base base-devel</code> , 网络相关还有 <code>vim pacman</code> 一些会用到的软件先装了<br>之后写一个分区表, 就是 <code>fstab</code> 开头的命令, 之后 <code>arch-chroot /mnt</code> 进入那个系统</p>
<p>接着是用已经连接好的网络安装软件和配置挂载的系统, 很多命令已经能用了<br>比如 <code>pacman</code> 在这个环境能安装, 也能用 <code>Vim</code>, 接下来修改相关配置文件<br>注意因为换到 <code>systemd</code>, 原先的 <code>rc.conf</code> 不再推荐, 注意看<a href="https://wiki.archlinux.org/index.php/Systemd_\(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87\"> Systemd 的 Wiki </a>#Replacing<em>ConsoleKit_with_systemd-logind)再进行配置<br>而且 [Wiki 上的安装教程](<a href="https://wiki.archlinux.org/index.php/Installation_Guide">https://wiki.archlinux.org/index.php/Installation_Guide</a></em>(%E6%AD%A3%E9%AB%94%E4%B8%AD%E6%96%87))也已经做了对应的修改, 默认 Systemd 的方式配置<br>这里有一步 <code>mkinitcpio -p linux</code> 用来做初始化内存盘的,, 我不太懂, 是照抄的<br>启动引导我看见到说 Arch 在推 <a href="https://wiki.archlinux.org/index.php/Syslinux_\(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87\">Syslinux</a>) 就不去用 Grub 了,<br>配置<a href="http://sandy.is-programmer.com/posts/36189.html">前面说过的这篇文章</a> 修改<code>/boot/syslinux/syslinux.cfg</code> 应当的分区<br>再执行 <code>syslinux-install_update -iam</code> 就可以了, 似乎 GNOME3 在这里正常的<br>完了再添加好用户以及密码, 再 回去 <code>umount</code> 和 <code>reboot</code> 可以看装好的系统了</p>
<p>没问题的话就是安装 GNOME3. 先<a href="https://wiki.archlinux.org/index.php/Beginners%27_Guide#Install_X">安装 X 和字体按照 Wiki 应该不会有问题</a><br>Nvidia 显卡驱动我用 <code>nvidia</code> 这个包直接装上还好也没问题, 安装 <code>gnome</code> 也没问题<br><a href="https://wiki.archlinux.org/index.php/GNOME_\(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87\">按 Wiki 上写的</a>#.E5.9C.A8.E6.96.B0.E7.B3.BB.E7.BB.9F.E4.B8.8A.E5.AE.89.E8.A3.85)安装配置好 <code>~/.xinitrc</code> 运行 <code>startx</code> 测试先没压力的<br>加上<a href="https://www.archlinuxcn.org/archlinux-cn-repo-and-mirror/">中文的仓库镜像</a>来安装 <code>yaourt</code>, 然后比如<a href="https://extensions.gnome.org/extension/440/workspace-separation-on-dash/">GNOME 扩展</a>还有其他一些定制<br><a href="https://wiki.archlinux.org/index.php/Systemd_\(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87\">后边用 <code>systemctl enable gdm</code> 就能快速设置桌面的开机启动了</a>#.E5.90.AF.E5.8A.A8.E6.A1.8C.E9.9D.A2.E7.8E.AF.E5.A2.83), 比以前方便</p>
<p>到了这里, 我开始遇到问题, <a href="https://groups.google.com/forum/?fromgroups=#!topic/archlinux-cn/uIDl8F8NbqU">一个是 Arch 开始用 systemd.logind 而不用 ConsoleKit,<br>因此登录桌面不能手动设置无线</a>, 即便 <code>networkmanaer</code> 用 <code>systemd</code> 已经启动<br>邮件列表同学指导说用 <code>netcfg</code>, 我找到了<a href="http://ihacklog.com/post/used-netcfg-to-setup-archlinux-network.html">清晰的教程</a>, <a href="https://wiki.archlinux.org/index.php/Netcfg_\(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87\">Wiki 上细节太多了</a>#Wireless_Association_failed.28.E6.97.A0.E7.BA.BF.E7.BD.91.E7.BB.9C.E8.BF.9E.E6.8E.A5.E5.A4.B1.E8.B4.A5.29)<br>思路就是复制模版新建好配置, 再到 Netcfg 配置选中配置名称, 并用 <code>systemctl</code> 启用</p>
<p>另一个是 IBus 在 GNOME3.6 不能用, <a href="https://bbs.archlinuxcn.org/viewtopic.php?id=1277">中文</a>和<a href="https://bbs.archlinux.org/search.php?search_id=2056567048">英文的不少在帖子在着急</a><br>大概是 <a href="ttps://bugs.archlinux.org/task/32152">IBus 的 Bug</a>, 只能等修复了, 暂时我没有好办法<br>还有是蓝牙, 图标每次开机都亮着, 我用<a href="http://siripong-computer-tips.blogspot.com/2011/10/blacklist-disable-bluetooth-kernel.html">把对应内核模块加入黑名单</a>还不行<br><a href="https://bbs.archlinux.org/viewtopic.php?id=142202">又想起来去刷新了一遍映像</a>, 还不成, 但在 <code>lsmod</code> 和 <code>systemctl</code> 都不见了<br><a href="https://wiki.archlinux.org/index.php/Mkinitcpio_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87">mkinitcpio 在 Wiki 上的内容</a>)不是很理解, 总之没有能解决掉图标的开启状态</p>
<p>之后大概 nginx 和 sshd 都用通过 <code>systemctl</code> 来启动和停止了, 不太习惯的感觉<br>另外还有些桌面美化的事情, 觉得难度也比较高, 不过对系统使用的影响不太大<br>个人感觉 Arch 安装在熟悉之后可以挺方便的, 但配置文件实在太多, 对新手不友好</p>
<p>完了发现有 Chrome 打开多个页面的会卡死 OS 的问题, 看下<a href="http://kodango.me/install-archlinux-with-vbox">这篇</a><br>怀疑是 <code>genfstab</code> 时没有先 <code>swapon</code> 的缘故, 我手写分区表, 不清楚是否全解决<br>进展我应该会在 <a href="https://bbs.archlinuxcn.org/viewtopic.php?id=1315">arch 中文论坛</a>上更新状态的</p>
</div><div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'jiyinyiyong';
      // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script');
          dsq.type = 'text/javascript';
          dsq.async = true;
          dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
          if (document.getElementsByTagName('head')[0]) {
            document.getElementsByTagName('body')[0].appendChild(dsq);
          }
      })();
  </script>
  <noscript>
    Please enable JavaScript to view the
    <a href="http://disqus.com/?ref_noscript">
      comments powered by Disqus.
    </a>
  </noscript>
  <a href="http://disqus.com" class="dsq-brlink">
    comments powered by
    <span class="logo-disqus">
      Disqus
    </span>
  </a>
</div><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-41753901-1', 'jiyinyiyong.github.io');
  ga('send', 'pageview');
</script>